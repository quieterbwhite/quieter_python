# Kafka重要核心概念解析

## 基本信息
```
Apache Kafka本质上是一款分布式、基于发布/订阅机制的消息系统,主要使用Scala语言开发而成的。
这里使用了『主要』两字,说明Kafka的源码并非全部都使用Scala语言开发,有相当一部分代码是使用Java语言开发的,特别是针对于客户端的部分。

Kafka的底层实际上是非常复杂的,里面涉及到大量的模式、算法、并发处理逻辑;当然,还涉到很多Java NIO(如Selector、Channel、Buffer等)、零拷贝、异步通信等模块。
```

## Kafka重要概念
```
生产者(Producer)

    它的主要工作就是源源不不断地生产出消息,然后发送给消息队列。
    生产者可以向消息队列发送各种类型的消息,如狭义的字符串消息(正如第2节课的示例所演示的那样,发送了了一个字符串消息),也可以发送二进制消息。
    
消费者(Consumer)
    
    pass

代理(Broker)

    在消息队列领域中,它指的其实就是消息队列产品本身,比如说在Kafka这个领域下,Broker其实指的就是一台Kafka Server。
    换句话说,我们可以将部署的一台Kafka Server看作是一个Broker,就是这样简单。
    那么从流程上来说,生生产者会将消息发送给Broker,然后消费者再从Broker中拉取消息。
    
主题(Topic)

    首先,主题是一个逻辑上的概念,它用于从逻辑上来归类与存储消息本身。
    多个生产者可以向一个Topic发送消息,同时也可以有多个消费者消费一个Topic中的消息。
    
    Topic还有分区与副本的概念。
    
    Kafka中的每一条消息都会归属于某一个Topic,而一个Topic下面可以有任意数量的消息。
    Topic是一个字符串。通过Topic这样一个逻辑上的概念,我们就很好地实现了生产者与消费者之间有针对性的发送与拉取。
    
消息(Record)

    消息是整个消息队列中最为基本的一个概念,也是最为原子的一个概念。它指的是生产者发送与消费者拉取的一个原子事物。
    消息由一串字节所构成,其中主要由key和value两部分内容,key与value本质山都是字节数组。在发送消息时,我们可以省略掉key部分,而直接使用value部分。
    对于Kafka的消息来说,真正的消息内容本身是由value所承载的。为了提升消息发送的消息和存储效率,生产者会批量将消息发送给Broker,并根据相应的压缩算法在发送前对消息进行压缩。
    
集群(Cluster)

    集群指的是由多个Broker所共同构成的一个整体,对外提供统一的服务,这类似于我们在部署系统时都会采用集群的方式来进行。
    借助于集群的方式,Kafka消息队列系统可以实现高可用与容错,即一台Broker挂掉了也不影响整个消息系统的正确运行。
    集群中的各台Broker之间是通过心跳(Heartbeat)的方式来检测其他机器是否还存活。
    
控制器(Controller)

    控制器是集群中的概念。每个集群中会选择出一个Broker担任控制器的⻆色,控制器是Kafka集群的中心。
    一个Kafka集群中,控制器这台Broker之外的其他Broker会根据控制器的指挥来实现相应的功能。
    控制器负责管理Kafka分区的状态、管理每个分区的副本状态、监听ZooKeeper中数据的变化并作出相应的反馈等功能。

消费者组(Consumer Group)

    这又是Kafka中的一个核心概念。消费者组与消费者之间密切相关。
    在Kafka中,多个消费者可以共同构成一个消费者组,而一个消费者只能从属于一个消费者组。
    消费者组最为重要的一个功能是实现广播与单播的功能。
    一个消费者组可以确保其所订阅的Topic的每个分区只能被从属于该消费者组中的唯一一个消费者所消费;
    如果不同的消费者组订阅了同一个Topic,那么这些消费者组之间是彼此独立的,不会受到相互的干扰。
    因此,如果我们希望一条消息可以被多个消费者所消费,那就可以将这些消费者放置到不同的消费者组中,这实际上就是广播的效果;
    如果希望一条消息只能被一个消费者所消费,那么就可以将这些消费者放置到同一个消费者组中,这实际上就是单播的效果。
```
