# 创建项目

## 在线创建一个项目
```
到网站 start.spring.io 上创建 maven 项目

first:
    Group: com.itmuch.cloud

    Artifact: microservice-simple-provider-user

    dependencies: Web, JPA, H2

second:
    Group: com.itmuch.cloud

    Artifact: microservice-simple-consumer-movie

    dependencies: Web

下载项目，解压

导入项目到 idea

新建 schema.sql data.sql 到 resources 目录下

创建实体 User
```

## 创建 schema.sql 建表语句
```sql
DROP TABLE user if EXISTS;

CREATE TABLE user (
    id bigint generated by default as IDENTITY, -- H2 语法，表示自增主键
    username varchar(40),
    name varchar(20),
    age int(3),
    balance DECIMAL(10, 2),
    PRIMARY key(id)
);
```

## 插入数据语句 data.sql
```sql
INSERT INTO user(id, username, name, age, balance) values(1, 'user1', 'one', 20, 100.00);
INSERT INTO user(id, username, name, age, balance) values(2, 'user2', 'two', 20, 100.00);
INSERT INTO user(id, username, name, age, balance) values(3, 'user3', 'three', 20, 100.00);
INSERT INTO user(id, username, name, age, balance) values(4, 'user4', 'four', 20, 100.00);
INSERT INTO user(id, username, name, age, balance) values(5, 'user5', 'five', 20, 100.00);
```

## 实体 User  entity/User.java
```
//Created by bwhite on 18-3-4.
@Entity
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @Column
    private String username;

    @Column
    private String name;

    @Column
    private short age;

    @Column
    private BigDecimal balance;

    // getter & setter
}
```

## DAO repository/UserRepository.java
```
@Repository  // 表示是一个 DAO
public interface UserRepository extends JpaRepository<User, Long> {
}
```

## controller/UserController.java
```
// 简单的例子， 就直接 controller 调用 repository 了
@RestController
public class UserController {

    @Autowired
    private UserRepository userRepository;

    @GetMapping("/simple/{id}")
    public User findById(@PathVariable Long id) {
        return this.userRepository.findOne(id);
    }
}
```

## 配置文件 application.yml
```
server:
  port: 7900
spring:
  jpa:
    generate-ddl: false  # 启动时要不要生成 ddl 语句，因为我们自己写了，就不需要生成了 false
    show-sql: false      # 打印sql语句
    hibernate:           # jpa 依赖 hebernate, 所以对 hebernate 进行配置
      ddl-auto: none     # 启动时不做 ddl 语句的处理
  datasource:
    platform: h2         # 使用h2数据库
    schema: classpath:schema.sql  # 建表语句
    data: classpath:data.sql      # 数据
logging:
  level:
    root: INFO
    org.hibernate: INFO  # 这三句，显示sql语句，同时把参数都打印出来
    org.hibernate.type.descripter.sql.BasicBinder: TRACE
    org.hibernate.type.descripter.sql.BasicExtractor: TRACE
    com.itmuch: DEBUG
```

## 启动类
```
// 约定，启动类在最外层，否则 controller, repository, entity 是不扫描的

@SpringBootApplication
public class MicroserviceSimpleProviderUserApplication {

    public static void main(String[] args) {
        SpringApplication.run(MicroserviceSimpleProviderUserApplication.class, args);
    }
}
```
